# 기술 스택 문서

새 프로젝트를 동일한 기술 스택으로 시작하기 위한 참고 문서

---

## 1. Backend

| 항목 | 기술 | 버전 |
|------|------|------|
| 언어 | Python | 3.11 |
| 프레임워크 | FastAPI | 0.109.0 |
| ASGI 서버 | Uvicorn (standard) | 0.27.0 |
| ORM | SQLAlchemy (async) | 2.0.25 |
| DB 드라이버 | asyncpg | 0.29.0 |
| 마이그레이션 | Alembic | 1.13.1 |
| 유효성 검증 | Pydantic | 2.5.3 |
| 설정 관리 | pydantic-settings | 2.1.0 |
| JWT 인증 | python-jose[cryptography] | 3.3.0 |
| 비밀번호 해싱 | bcrypt | 4.0.1 |
| 이미지 처리 | Pillow | 10.2.0 |
| HTTP 클라이언트 | httpx | 0.26.0 |
| 환경변수 | python-dotenv | 1.0.0 |
| 이메일 검증 | email-validator | 2.1.0 |
| 폼 파싱 | python-multipart | 0.0.6 |

### requirements.txt

```
fastapi==0.109.0
uvicorn[standard]==0.27.0
sqlalchemy==2.0.25
asyncpg==0.29.0
alembic==1.13.1
pydantic==2.5.3
pydantic-settings==2.1.0
python-jose[cryptography]==3.3.0
bcrypt==4.0.1
python-dotenv==1.0.0
email-validator==2.1.0
python-multipart==0.0.6
Pillow==10.2.0
httpx==0.26.0
```

### 인증 설정

- 알고리즘: HS256
- Access Token 만료: 30분
- Refresh Token 만료: 7일
- 비밀번호: SHA-256 사전 해싱 + bcrypt

---

## 2. Frontend

| 항목 | 기술 | 버전 |
|------|------|------|
| 프레임워크 | Next.js (App Router) | 14.2.0 |
| UI 라이브러리 | React | 18.2.0 |
| 언어 | TypeScript (strict) | 5.4.5 |
| CSS 프레임워크 | Tailwind CSS | 3.4.3 |
| 상태 관리 | Zustand | 4.5.2 |
| 폼 처리 | react-hook-form | 7.51.3 |
| 폼 검증 | Zod | 3.22.5 |
| 폼 리졸버 | @hookform/resolvers | 3.3.4 |
| HTTP 클라이언트 | axios | 1.6.8 |
| 차트 | Recharts | 2.12.6 |
| 아이콘 | lucide-react | 0.372.0 |
| 날짜 처리 | date-fns | 3.6.0 |
| 타임존 | date-fns-tz | 3.2.0 |
| 드래그 앤 드롭 | @dnd-kit/core | 6.3.1 |
| | @dnd-kit/sortable | 10.0.0 |
| | @dnd-kit/utilities | 3.2.2 |
| 클래스 유틸 | clsx | 2.1.0 |
| 클래스 병합 | tailwind-merge | 2.2.2 |
| PostCSS | postcss | 8.4.38 |
| Autoprefixer | autoprefixer | 10.4.19 |
| 린터 | ESLint (eslint-config-next) | 8.57.0 |

### package.json 주요 설정

```json
{
  "dependencies": {
    "@dnd-kit/core": "^6.3.1",
    "@dnd-kit/sortable": "^10.0.0",
    "@dnd-kit/utilities": "^3.2.2",
    "@hookform/resolvers": "^3.3.4",
    "axios": "^1.6.8",
    "clsx": "^2.1.0",
    "date-fns": "^3.6.0",
    "date-fns-tz": "^3.2.0",
    "lucide-react": "^0.372.0",
    "next": "14.2.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-hook-form": "^7.51.3",
    "recharts": "^2.12.6",
    "tailwind-merge": "^2.2.2",
    "zod": "^3.22.5",
    "zustand": "^4.5.2"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "autoprefixer": "^10.4.19",
    "eslint": "^8",
    "eslint-config-next": "14.2.0",
    "postcss": "^8.4.38",
    "tailwindcss": "^3.4.3",
    "typescript": "^5"
  }
}
```

### Next.js 설정

```js
// next.config.js
const nextConfig = {
  output: 'standalone',
  async rewrites() {
    return [
      { source: '/api/:path*', destination: 'http://backend:8000/api/:path*' }
    ];
  }
};
```

### TypeScript 설정

```json
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "module": "esnext",
    "moduleResolution": "bundler",
    "jsx": "preserve",
    "strict": true,
    "paths": { "@/*": ["./src/*"] }
  }
}
```

### Tailwind 커스텀 테마

```ts
// tailwind.config.ts
theme: {
  extend: {
    colors: {
      primary: {
        50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe',
        300: '#93c5fd', 400: '#60a5fa', 500: '#3b82f6',
        600: '#2563eb', 700: '#1d4ed8', 800: '#1e40af',
        900: '#1e3a8a', 950: '#172554'
      }
    }
  }
}
```

---

## 3. 데이터베이스

| 항목 | 값 |
|------|-----|
| DBMS | PostgreSQL 15 (Alpine) |
| 드라이버 | asyncpg (비동기) |
| 기본 DB명 | money_tracker |
| 기본 사용자 | postgres / postgres |
| 포트 | 5432 |

---

## 4. 인프라 (Docker)

### docker-compose.yml

```yaml
version: '3.8'

services:
  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: money_tracker
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 5s
      timeout: 5s
      retries: 5

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    environment:
      - DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/money_tracker
      - SECRET_KEY=your-super-secret-key-change-in-production
      - DEBUG=true
      - TZ=Asia/Seoul
    ports:
      - "8000:8000"
    depends_on:
      db:
        condition: service_healthy
    volumes:
      - ./backend:/app
      - uploads_data:/app/uploads
    restart: unless-stopped

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    environment:
      - NEXT_PUBLIC_API_URL=http://localhost:8000/api/v1
    ports:
      - "3000:3000"
    depends_on:
      - backend
    restart: unless-stopped

volumes:
  postgres_data:
  uploads_data:
```

### Backend Dockerfile

```dockerfile
FROM python:3.11-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY . .
EXPOSE 8000
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]
```

### Frontend Dockerfile (멀티스테이지)

```dockerfile
# Stage 1: Dependencies
FROM node:20-alpine AS deps
WORKDIR /app
COPY package.json package-lock.json ./
RUN npm ci

# Stage 2: Build
FROM node:20-alpine AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN npm run build

# Stage 3: Runner
FROM node:20-alpine AS runner
WORKDIR /app
RUN addgroup --system --gid 1001 nodejs && adduser --system --uid 1001 nextjs
COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static
USER nextjs
EXPOSE 3000
ENV PORT 3000
CMD ["node", "server.js"]
```

---

## 5. 프로젝트 디렉터리 구조

```
project-root/
├── backend/
│   ├── app/
│   │   ├── main.py                 # FastAPI 앱 진입점
│   │   ├── api/v1/
│   │   │   ├── router.py           # API 라우터
│   │   │   └── endpoints/          # 엔드포인트 모듈들
│   │   ├── core/
│   │   │   ├── config.py           # 설정 (pydantic-settings)
│   │   │   ├── security.py         # JWT, 비밀번호 유틸
│   │   │   └── deps.py             # 의존성 주입
│   │   ├── db/
│   │   │   └── database.py         # SQLAlchemy 비동기 세션
│   │   ├── models/                 # SQLAlchemy ORM 모델
│   │   ├── schemas/                # Pydantic 스키마
│   │   └── services/               # 비즈니스 로직
│   ├── migrations/                 # Alembic 마이그레이션
│   ├── uploads/                    # 파일 업로드 디렉터리
│   ├── Dockerfile
│   ├── requirements.txt
│   └── .env
├── frontend/
│   ├── src/
│   │   ├── app/                    # Next.js App Router 페이지
│   │   ├── components/
│   │   │   ├── ui/                 # 재사용 UI 컴포넌트
│   │   │   ├── layout/             # 레이아웃 컴포넌트
│   │   │   └── forms/              # 폼 컴포넌트
│   │   ├── hooks/                  # 커스텀 React 훅
│   │   ├── lib/                    # 유틸리티 함수
│   │   ├── store/                  # Zustand 상태 관리
│   │   └── types/                  # TypeScript 타입 정의
│   ├── public/                     # 정적 파일
│   ├── Dockerfile
│   ├── next.config.js
│   ├── tailwind.config.ts
│   ├── tsconfig.json
│   ├── package.json
│   └── .env.local
├── docker-compose.yml
└── docker-compose.dev.yml
```

---

## 6. 주요 아키텍처 패턴

- **Backend**: RESTful API, 비동기 우선 설계, 서비스 레이어 패턴
- **Frontend**: Next.js App Router (서버/클라이언트 컴포넌트 혼합)
- **인증**: JWT Access + Refresh Token
- **API 통신**: Axios + 환경변수 기반 API URL
- **폼 처리**: react-hook-form + Zod 스키마 검증
- **상태 관리**: Zustand (경량 스토어)
- **스타일링**: Tailwind CSS (유틸리티 클래스)
- **타임존**: Asia/Seoul 통일
